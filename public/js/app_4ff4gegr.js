var st_ver="0.139",tg=window.Telegram.WebApp,ball=document.getElementById("load-wrap"),notifier=document.getElementById("notifier");tg.expand(),tg.SettingsButton.show(),Telegram.WebApp.onEvent("settingsButtonClicked",function(){window.location.reload(!0)});let theme=tg.themeParams;btnOpen=document.getElementById("open_scanner"),btnOpen.style.backgroundColor=theme.button_color,btnOpen.style.color=theme.button_text_color;var tableId=null;function updateTableNumber(){return null!==tableId&&/^\d+$/.test(tableId)?($("#tablenumber").val(tableId),$("#tablenumber").text(" üçΩ –ù–æ–º–µ—Ä —Å—Ç–æ–ª–∞: "+tableId),tg.closeScanQrPopup(),void notify(`–ù–æ–º–µ—Ä —Å—Ç–æ–ª–∞: ${tableId}`)):(console.error("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π tableId:",tableId),tg.showAlert("–ù–µ —Å–º–æ–≥ —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å qr-code"),!1)}tg.onEvent("qrTextReceived",async function({data:e}){var t=e.toString().toLowerCase();if(t.startsWith("http://")||t.startsWith("https://")){if(t.startsWith("https://tapper.cloud/")){let e=function(e){let t=e.indexOf("https://tapper.cloud/")+"https://tapper.cloud/".length,n=e.substring(t).split("/"),o=n[n.length-1].match(/\d+/);return o?o[0]:null}(t);return console.log("–ü–æ—Å–ª–µ–¥–Ω—è—è —Ü–∏—Ñ—Ä–∞:",e),tableId=e,updateTableNumber()}if(t.startsWith("https://eda.yandex.ru/inplace/menu?uuid=")){let e=function(e,t){let n=e.indexOf(t+"=");if(-1===n)return null;n+=t.length+1;let o=e.indexOf("&",n);return-1===o&&(o=e.length),e.substring(n,o)}(t,"uuid");console.log("–ó–Ω–∞—á–µ–Ω–∏–µ uuid:",e);let n="https://api.edatg.ru/webhook/tableId",o={uuid:e};!async function(){try{const e=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!e.ok)throw new Error("Network response was not ok");const t=await e.json();console.log("–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:",t),tableId=t.table_id,console.log("–ü–æ–ª—É—á–µ–Ω–Ω—ã–π tableId:",tableId),updateTableNumber()}catch(e){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞:",e)}}()}}else tg.showAlert("–ù–µ —Å–º–æ–≥ —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å qr-code")}),btnOpen.addEventListener("click",function(){try{if("tdesktop"===tg.platform)return void notify("–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ");tg.showScanQrPopup({text:tableId?`–ù–æ–º–µ—Ä —Å—Ç–æ–ª–∞: ${tableId}`:"–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ qr-code —Å—Ç–æ–ª–∞"},function(){return!1})}catch(e){console.error("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: ",e.message)}});var departments={};const token="ae88835bdbe058921eb8012bc6b79a7a7e606ac9";var selectedAddress,currentDepartmentId,type="ADDRESS",$street=$("#street"),$house=$("#house"),$message=$("#message"),selection="<option value='now'>‚åöÔ∏è –ë–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è</option>";function preload(e){e.style.opacity=1;var t=setInterval(function(){e.style.opacity=e.style.opacity-.05,e.style.opacity<=.05&&(clearInterval(t),ball.style.display="none")},15)}function notify(e){notifier.className;notifier.className="warning show",$("#notifier").text(e),setTimeout(function(){notifier.className="warning"},1500)}function getMachineId(){try{let e=localStorage.getItem("uuid");return e||(e=self.UUID.generate(),localStorage.setItem("uuid",e)),e}catch(e){return console.log(e),"error"}}function zeroFill(e,t){return(t-=e.toString().length)>0?new Array(t+(/\./.test(e)?2:1)).join("0")+e:e+""}function selectAddress(e){console.log(e),e.data.house?console.log("–í–µ—Ä–Ω–æ, –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å!"):(console.log("–£–∫–∞–∂–∏—Ç–µ –Ω–æ–º–µ—Ä –¥–æ–º–∞, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å"),$("#house")[0].reportValidity(),document.getElementById("house").focus()),selectedAddress=e.data,seladdr=e.data.city_kladr_id,tg_kladrid=e.data.street_kladr_id,tg_street=e.data.street_with_type,tg_house=e.data.house_type+" "+e.data.house,tg_geo_lat=e.data.geo_lat,tg_geo_lon=e.data.geo_lon,tg_qc_geo=e.data.qc_geo,tg_qc=e.data.qc,tg_full_street=e.unrestricted_value,null==e.data.block?tg_building="":tg_building=e.data.block_type+" "+e.data.block}function selectNone(){selectedAddress=null}function get_data_load(){let e=localStorage.getItem("t_name"),t=localStorage.getItem("t_phone"),n=localStorage.getItem("t_address"),o=localStorage.getItem("t_flat"),a=localStorage.getItem("t_floor"),l=localStorage.getItem("t_entrance"),i=localStorage.getItem("t_intercom");e&&(console.log("–ù–∞–π–¥–µ–Ω: –∏–º—è"),$("#name").val(e)),t&&(console.log("–ù–∞–π–¥–µ–Ω: –¢–µ–ª–µ—Ñ–æ–Ω"),$("#phone").val(t)),o&&(console.log("–ù–∞–π–¥–µ–Ω: –∫–≤"),$("#flat").val(o)),a&&(console.log("–ù–∞–π–¥–µ–Ω: —ç—Ç–∞–∂"),$("#floor").val(a)),l&&(console.log("–ù–∞–π–¥–µ–Ω: –ø–æ–¥—ä–µ–∑–¥"),$("#entrance").val(l)),i&&(console.log("–ù–∞–π–¥–µ–Ω: –¥–æ–º–æ—Ñ–æ–Ω"),$("#intercom").val(i)),console.log("–°–≤–æ–±–æ–¥–Ω—ã–π –≤—ã–±–æ—Ä –¥–æ–º–æ–≤");let r=localStorage.getItem("t_address"),s=localStorage.getItem("t_house");s&&(console.log("–ù–∞–π–¥–µ–Ω: –¥–æ–º"),$("#house").val(s)),r?(console.log("–ê–¥—Ä–µ—Å –Ω–∞–π–¥–µ–Ω –ø–æ–¥–≥—Ä—É–∂–∞—é"),$("#street").val(n),$house.on("suggestions-fixdata",function(e,t){}),$house.suggestions().fixData()):console.log("–î–∞–Ω–Ω—ã–µ –ø–æ –∞–¥—Ä–µ—Å—É –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")}async function loadApi(){try{const e={},t={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+obj.hash},body:JSON.stringify(e)},n=new AbortController,o=n.signal,a=setTimeout(()=>{n.abort()},1e4);let l=await fetch("https://api.edatg.ru/webhook/hash/",{...t,signal:o});if(clearTimeout(a),l.ok)return await l.json();{const e=await l.text();throw notify("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∞–π—Ç–∞"),$("#error_load").text(`–û—à–∏–±–∫–∞: ${l.status} - ${e}`),new Error(`Fetch error: ${l.status}`)}}catch(e){throw console.error("Fetch error:",e),notify("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∞–π—Ç–∞"),$("#error_load").text("–£–ø—Å, —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, —Å–∫–æ—Ä–æ –≤—Å—ë –ø–æ—á–∏–Ω–∏–º.\n –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–∫–ª—é—á–∏—Ç—å VPN –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É."),e}}function checkAndUpdateTimeSelection(e,t=40){console.log("checkAndUpdateTimeSelection:",e);var n=$("select").val();if("now"===n)return!1;var o=moment(n),a=moment().tz(e.time_zona);return console.log("Current time:",a.format("HH:mm")),console.log("Selected time:",o.format("HH:mm")),o.diff(a,"minutes")<=t&&(console.log("Difference in minutes:",o.diff(a,"minutes")),updateAvailableTimes(e.id),tg.showAlert("–í—ã–±—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –±–æ–ª—å—à–µ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–æ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–≤–æ–µ –≤—Ä–µ–º—è."),!0)}function updateAvailableTimes(e){currentDepartmentId=e,console.log("Updating times for department ID:",e);var t=departments.globalSettings.departments.find(function(t){return t.id===e});if(t){var n=t.workTime,o=moment().tz(t.time_zona),a=o.clone().add(40,"minutes"),l=(a.clone().startOf("day"),moment().add(1,"days").tz(t.time_zona));function i(e,t,n,a){var l=moment(n.from,"HH:mm"),i=moment(n.to,"HH:mm"),r=a?Math.max(e.hour()+1,n.fullDay?0:l.hour()+1):n.fullDay?0:l.hour()+1,s=n.fullDay?24:i.hour(),c="",d=!1;if(console.log(`Generating options for ${t} (${e.format("YYYY-MM-DD")})`),!d&&a){const e=i.diff(o,"minutes"),a=o.diff(l,"minutes");console.log("–î–æ –∑–∞–∫—Ä—ã—Ç–∏—è",e),console.log("–î–æ –æ—Ç–∫—Ä—ã—Ç–∏—è",a),n.fullDay||a>0&&e>10?(console.log(`Adding nearest time option for ${t}`),c+="<option value='now'>‚åöÔ∏è –ë–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è</option>",d=!0):(e<=10&&alert(`–î–æ –∑–∞–∫—Ä—ã—Ç–∏—è –∑–∞–≤–µ–¥–µ–Ω–∏—è –æ—Å—Ç–∞–ª–æ—Å—å –º–µ–Ω—å—à–µ 10 –º–∏–Ω—É—Ç. –í—ã –º–æ–∂–µ—Ç–µ —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑ —Ç–æ–ª—å–∫–æ –Ω–∞ –∑–∞–≤—Ç—Ä–∞ c ${l.format("HH:mm")}.`),a<0&&alert(`–ú—ã –Ω–∞—á–Ω—ë–º –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–∫–∞–∑—ã —Å ${l.format("HH:mm YYYY-MM-DD")}.`))}for(var u=r;u<=s;u++){var g=zeroFill(u,2),m=e.clone().set({hour:u,minute:0,second:0});c+=`<option value='${m.format()}'>‚åöÔ∏è ${g}:00 ${t}</option>`,u<s&&(m.set({minute:30}),c+=`<option value='${m.format()}'>‚åöÔ∏è ${g}:30 ${t}</option>`)}return c}console.log("Adjusted time after adding 40 minutes:",a.format("YYYY-MM-DD HH:mm")),$("select").empty();var r="";r+=i(a,"–°–µ–≥–æ–¥–Ω—è",n[0],!0),r+=i(l,"–ó–∞–≤—Ç—Ä–∞",n[1],!1),$("select").html(r),checkAndUpdateTimeSelection(t)}}function button_sendData(){tg.MainButton.show(),tg.MainButton.text="–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å",tg.MainButton.setText("–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"),tg.MainButton.textColor="#FFFFFF",tg.MainButton.color="#32746a",tg.MainButton.setParams({color:"#32746a"}),tg.MainButton.enable(),tg.enableClosingConfirmation()}function button_block(){tg.MainButton.show(),tg.MainButton.text="–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å",tg.MainButton.setText("–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"),tg.MainButton.textColor="#FFFFFF",tg.MainButton.color="#0e0e10",tg.MainButton.setParams({color:"#0e0e10"}),tg.MainButton.enable(),tg.enableClosingConfirmation()}list_payment={paysbp:{alt:"–°–ë–ü (–°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π)",title:"–°–ë–ü",img:"image/sbp_icons.png"},paycard:{alt:"–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞",title:"–ë–∞–Ω–∫–æ–≤—Å–∫–æ–π –∫–∞—Ä—Ç–æ–π –æ–Ω–ª–∞–π–Ω",img:"image/card_icon.png"},paycash:{alt:"–ù–∞–ª–∏—á–Ω—ã–º–∏ –∏–ª–∏ –∫–∞—Ä—Ç–æ–π –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏",title:"–ù–∞–ª–∏—á–Ω—ã–º–∏ –∏–ª–∏ –∫–∞—Ä—Ç–æ–π –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏",img:"image/money_icon.png"}},Telegram.WebApp.onEvent("mainButtonClicked",function(){if(console.log("–í—ã–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫—É –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å: –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π"),notify("–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ä–º—ã..."),!checkAndUpdateTimeSelection(departments.globalSettings.departments.find(function(e){return e.id===currentDepartmentId})))try{var e={platform:tg.platform,guuid:getMachineId(),web_ver:st_ver,name:"",phone:"",shipping_type:"",payment_type:"",delivery_time:$("#delivery_time").val(),cutlery:$("#cutlery").val(),comment:$("#comment").val(),tablenumber:"",address:""},t=$("#name").val(),n=$("#phone").val(),o=$("input[name=shipping_type]:checked").val(),a=$("input[name=payment_type]:checked").val(),l=$("input[name=address_pickup]:checked").val();if(t.length<2)return document.getElementById("name").focus(),$("#name")[0].reportValidity(),notify("–ò–º—è —É–∫–∞–∑–∞–Ω –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ");if(e.name=t,localStorage.setItem("t_name",t),n.length<16)return document.getElementById("phone").focus(),$("#phone")[0].reportValidity(),notify("–¢–µ–ª–µ—Ñ–æ–Ω —É–∫–∞–∑–∞–Ω –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ");if(e.phone=n,localStorage.setItem("t_phone",n),"delivery"==o){if(e.shipping_type="üöõ –î–æ—Å—Ç–∞–≤–∫–∞",console.log("üöõ –î–æ—Å—Ç–∞–≤–∫–∞"),null==selectedAddress)return document.getElementById("street").focus(),$("#street")[0].reportValidity(),notify("–í—ã–±–µ—Ä–∏—Ç–µ –£–ª–∏—Ü—É –∏ –¥–æ–º");if(null==selectedAddress.house)return document.getElementById("house").focus(),$("#house")[0].reportValidity(),notify("–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –î–æ–º–∞");var i=$("#flat").val(),r=$("#floor").val(),s=$("#entrance").val(),c=$("#intercom").val();e.address={full_street:tg_full_street,street:tg_street,house:tg_house,building:tg_building,flat:i,floor:r,entrance:s,intercom:c,kladrid:tg_kladrid,order_place_comment:$("#order_place_comment").val(),location:{lat:tg_geo_lat,lon:tg_geo_lon},qc_geo:tg_qc_geo,qc:tg_qc},localStorage.setItem("t_address",tg_street),localStorage.setItem("t_house",tg_house+tg_building),localStorage.setItem("t_flat",i),localStorage.setItem("t_floor",r),localStorage.setItem("t_entrance",s),localStorage.setItem("t_intercom",c)}if("takeout"==o){if(null==l)return notify("–í—ã–±–µ—Ä–∏—Ç–µ –≥–¥–µ —Ö–æ—Ç–∏—Ç–µ –∑–∞–±—Ä–∞—Ç—å –∑–∞–∫–∞–∑");e.address_pickup=l,e.shipping_type="üèÉ –ù–∞–≤—ã–Ω–æ—Å",console.log("üèÉ –ù–∞–≤—ã–Ω–æ—Å")}if("inside"==o){if(null==l)return notify("–í—ã–±–µ—Ä–∏—Ç–µ –≥–¥–µ —Ö–æ—Ç–∏—Ç–µ –∑–∞–±—Ä–∞—Ç—å –∑–∞–∫–∞–∑");e.address_pickup=l,e.shipping_type="üçΩ –í –∑–∞–≤–µ–¥–µ–Ω–∏–∏",e.tablenumber=$("#tablenumber").val(),console.log("üçΩ –í –∑–∞–≤–µ–¥–µ–Ω–∏–∏")}e.payment_type=a,tg.sendData(JSON.stringify(e))}catch(e){console.log("–û—à–∏–±–∫–∞",e),$("#error_t").text("–û—à–∏–±–∫–∞: "+e),notify("–û—à–∏–±–∫–∞: "+e)}}),validParams=["hash"];const params=window.location.search.substring(1).split("&"),filteredParams=params.filter(e=>([name]=e.split("="),validParams.includes(name))),obj={};for(const e of filteredParams){const[t,n]=e.split("=");obj[t]=n}function DeliveryOptions(e){const t=document.getElementById("delivery-options-container"),n=document.getElementById("delivery-address"),o=document.getElementById("personal-details"),a=document.getElementById("pickup-location"),l=document.getElementById("table-number");function i(){const e=Array.from(t.children);e.sort((e,t)=>{const n=e.classList.contains("unavailable"),o=t.classList.contains("unavailable");return n&&!o?1:!n&&o?-1:0}),e.forEach(e=>{t.appendChild(e)})}function r(){if(!t)return void console.error("Delivery options container not found in the document.");t.innerHTML="",Object.keys(e).forEach(r=>{const s=e[r],c=function(e,t,n,o){const a=document.createElement("label");a.classList.add("delivery-option"),o||a.classList.add("unavailable"),a.id=`option-item-${e}`;const l=document.createElement("input");l.classList.add("option-input"),l.id=`option-${e}`,l.name="shipping_type",l.type="radio",l.value=e,o||(l.disabled=!0);const i=document.createElement("div");i.classList.add("option-content");const r=document.createElement("div");r.classList.add("delivery-text"),r.textContent=t;const s=document.createElement("div");return s.classList.add("delivery-time"),s.textContent=n,i.appendChild(r),i.appendChild(s),a.appendChild(l),a.appendChild(i),a}(r,s.title,s.description,s.available);t.appendChild(c),c.querySelector(".option-input").addEventListener("change",function(){!function(){n.style.display="none",o.style.display="none",a.style.display="none",l.style.display="none",t.querySelectorAll(".option-input").forEach(e=>e.parentElement.classList.remove("selected"));const i=t.querySelector(".option-input:checked");if(i){const t=i.value;e[t].available&&(i.parentElement.classList.add("selected"),"delivery"===t?(o.style.display="block",n.style.display="block"):"takeout"===t?(o.style.display="block",a.style.display="block"):"inside"===t&&(o.style.display="block",a.style.display="block",l.style.display="block"))}}(),i()})}),i();const r=t.querySelector(".option-input:not([disabled])");r&&(r.checked=!0,r.dispatchEvent(new Event("change")))}window.updateDeliveryOptions=function(t){Object.keys(e).forEach(n=>{t.hasOwnProperty(n)&&(e[n]=t[n])}),r()},r()}function loadParams(e){try{tg.platform;var t=getMachineId();guuid_platform=" GUID: "+t,$("#guuid").text(guuid_platform);let l=e.globalSettings.payment_methods;l=null==l||void 0===l?["paysbp"]:0===l.length?["paysbp"]:l.split(",");let i=["method1","method2"];l.length>0&&(i=l[0]);let r="";l.forEach(function(e){r+=`<div class='radio-item'>\n                        <input class='radio-list' type='radio' name='payment_type' id='${e}' value='${e}' required ${e===i?"checked":""}>\n                        <label for='${e}'>\n                            <img src='${list_payment[e].img}' alt='${list_payment[e].alt}' class='checkout-payment__slider-image'>\n                            ${list_payment[e].title}\n                        </label>\n                    </div>`}),$(".payment-list").html(r),DeliveryOptions(e.globalSettings.delivery_methods),$(document).ready(function(){$(".delivery-option").hover(function(){var e=$(".delivery-container").scrollLeft(),t=$(this).position().left;$(".delivery-container").animate({scrollLeft:e+t},120)})});var n=e.globalSettings.departments[0].city;$street.suggestions({token:token,type:type,scrollOnFocus:!0,onSelect:selectAddress,onSelectNothing:selectNone,hint:"–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ –≤–≤–æ–¥",bounds:"street",constraints:{locations:[{city:n}]},restrict_value:!0}),$house.suggestions({token:token,type:type,scrollOnFocus:!0,onSelect:selectAddress,onSelectNothing:selectNone,hint:!1,noSuggestionsHint:!1,bounds:"house",constraints:$street});var o="";for(var a in e.globalSettings.departments)o+="<div class='radio-item'>",o+="<input class='radio-list' type='radio' name='address_pickup' id='"+e.globalSettings.departments[a].id+"' value='"+e.globalSettings.departments[a].id+"' required>",o+="<label for='"+e.globalSettings.departments[a].id+"'>",o+="<img src='image/map_icon.png' alt='"+e.globalSettings.departments[a].address+"' class='checkout-payment__slider-image'>",o+=e.globalSettings.departments[a].address,o+="</label>",o+="</div>";$(".departments").html(o),console.log("Departments:",e.globalSettings.departments),console.log("Selected Department ID:",""),$('input[type="radio"][name="address_pickup"]').change(function(){var t=$(this).val(),n=e.globalSettings.departments.find(function(e){return e.id===parseInt(t)});n?(console.log("Selected Department:",n),updateAvailableTimes(n.id),notify("–ò–∑–º–µ–Ω–∏–ª–æ—Å—å –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏.")):console.log("Department not found for ID:",t)}),$("select").change(function(){checkAndUpdateTimeSelection(e.globalSettings.departments.find(function(e){return e.id===currentDepartmentId}))}),$(document).ready(function(){e.globalSettings.departments.length>0&&updateAvailableTimes(e.globalSettings.departments[0].id)})}catch(e){return console.log(e),notify("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∞ —Å–∞–π—Ç–∞"),void $("#error_load").text("–û—à–∏–±–∫–∞: "+e)}$("#ver").text(" ver: "+st_ver),get_data_load()}window.onload=function(){loadApi().then(e=>{console.log("API response:",e),departments=e,loadParams(e),preload(ball),button_sendData()}).catch(e=>{console.error("API error:",e)})},window.addEventListener("DOMContentLoaded",function(){[].forEach.call(document.querySelectorAll(".tel"),function(e){var t;function n(e){e.keyCode&&(t=e.keyCode),this.selectionStart<3&&e.preventDefault();var n="+7 (___) ___-__-__",o=0,a=n.replace(/\D/g,""),l=this.value.replace(/\D/g,""),i=n.replace(/[_\d]/g,function(e){return o<l.length?l.charAt(o++)||a.charAt(o):e});-1!=(o=i.indexOf("_"))&&(o<5&&(o=3),i=i.slice(0,o));var r=n.substr(0,this.value.length).replace(/_+/g,function(e){return"\\d{1,"+e.length+"}"}).replace(/[+()]/g,"\\$&");(!(r=new RegExp("^"+r+"$")).test(this.value)||this.value.length<5||t>47&&t<58)&&(this.value=i),"blur"==e.type&&this.value.length<5&&(this.value="")}e.addEventListener("input",n,!0),e.addEventListener("focus",n,!0),e.addEventListener("blur",n,!0),e.addEventListener("keydown",n,!0)})});