var e=document.getElementById("load-wrap");function t(t){t.style.opacity=1;var o=setInterval((function(){t.style.opacity=t.style.opacity-.05,t.style.opacity<=.05&&(clearInterval(o),e.style.display="none")}),15)}window.onload=function(){setTimeout((function(){t(e),o.MainButton.show()}),770)};var o=window.Telegram.WebApp;o.expand(),o.MainButton.text="–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å",o.MainButton.setText("–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"),o.MainButton.textColor="#FFFFFF",o.MainButton.color="#32746a",o.MainButton.setParams({color:"#32746a"}),o.MainButton.enable(),o.enableClosingConfirmation(),validParams=["time_zone","work_hours","limit_streets"];const n=window.location.search.substring(1).split("&").filter((e=>([name]=e.split("="),validParams.includes(name)))),a={};for(const e of n){const[t,o]=e.split("=");a[t]=o}var l=a.work_hours.split(","),r=a.time_zone,u=JSON.parse(a.limit_streets),i=moment(l[0],"HH:mm"),s=moment(l[1],"HH:mm"),m=(new moment).format(),c=(m=moment.tz(m,r),(new moment).add(1,"days").format());c=moment.tz(c,r);if(u){var d=document.getElementById("streetlimit");d.parentNode.removeChild(d)}var g,_="<option value='now'>‚åöÔ∏è –ë–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è</option>",f=0;for(f=(g=void 0,g=Number(m.format("HH")),i.format("HH")<=g?g+1:i.format("HH"));f<s.format("HH");f++){var v=I(f,2),h=moment(m),p=v,y=moment(p,"HH:mm");h.set({hour:y.get("hour"),minute:y.get("minute"),second:y.get("second")}),Number(m.format("mm"))<=30&&(_+="<option value='"+h.format()+"'>‚åöÔ∏è "+v+":00 –°–µ–≥–æ–¥–Ω—è</option>");h=moment(m),p=v+30,y=moment(p,"HH:mm");h.set({hour:y.get("hour"),minute:y.get("minute"),second:y.get("second")}),_+="<option value='"+h.format()+"'>‚åöÔ∏è "+v+":30 –°–µ–≥–æ–¥–Ω—è</option>"}for(f=i.format("HH");f<s.format("HH");f++){v=I(f,2),h=moment(c),p=v,y=moment(p,"HH:mm");h.set({hour:y.get("hour"),minute:y.get("minute"),second:y.get("second")}),_+="<option value='"+h.format()+"'>‚åöÔ∏è "+v+":00 –ó–∞–≤—Ç—Ä–∞</option>";h=moment(c),p=v+30,y=moment(p,"HH:mm");h.set({hour:y.get("hour"),minute:y.get("minute"),second:y.get("second")}),_+="<option value='"+h.format()+"'>‚åöÔ∏è "+v+":30 –ó–∞–≤—Ç—Ä–∞</option>"}function I(e,t){return(t-=e.toString().length)>0?new Array(t+(/\./.test(e)?2:1)).join("0")+e:e+""}function S(){let e=localStorage.getItem("MachineId");return e||(e=crypto.randomUUID(),localStorage.setItem("MachineId",e)),e}$("select").html(_),window.addEventListener("DOMContentLoaded",(function(){[].forEach.call(document.querySelectorAll(".tel"),(function(e){var t;function o(e){e.keyCode&&(t=e.keyCode),this.selectionStart<3&&e.preventDefault();var o="+7 (___) ___-__-__",n=0,a=o.replace(/\D/g,""),l=this.value.replace(/\D/g,""),r=o.replace(/[_\d]/g,(function(e){return n<l.length?l.charAt(n++)||a.charAt(n):e}));-1!=(n=r.indexOf("_"))&&(n<5&&(n=3),r=r.slice(0,n));var u=o.substr(0,this.value.length).replace(/_+/g,(function(e){return"\\d{1,"+e.length+"}"})).replace(/[+()]/g,"\\$&");(!(u=new RegExp("^"+u+"$")).test(this.value)||this.value.length<5||t>47&&t<58)&&(this.value=r),"blur"==e.type&&this.value.length<5&&(this.value="")}e.addEventListener("input",o,!0),e.addEventListener("focus",o,!0),e.addEventListener("blur",o,!0),e.addEventListener("keydown",o,!0)}))}));const b="ae88835bdbe058921eb8012bc6b79a7a7e606ac9";var B,E="ADDRESS",H=$("#street"),k=$("#house");$("#message");function w(e){console.log(e),e.data.house?console.log("–í–µ—Ä–Ω–æ, –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å!"):(console.log("–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ –¥–æ–º–∞, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å"),$("#house")[0].reportValidity(),document.getElementById("house").focus()),B=e.data,seladdr=e.data.city_kladr_id,tg_kladrid=e.data.street_kladr_id,tg_street=e.data.street_with_type,tg_house=e.data.house_type+" "+e.data.house,tg_geo_lat=e.data.geo_lat,tg_geo_lon=e.data.geo_lon,tg_qc_geo=e.data.qc_geo,tg_full_street=e.unrestricted_value,null==e.data.block?tg_building="":tg_building=e.data.block_type+" "+e.data.block}function M(){B=null}H.suggestions({token:b,type:E,scrollOnFocus:!0,onSelect:w,onSelectNothing:M,hint:"–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ –≤–≤–æ–¥",bounds:"street",constraints:{locations:[{city:"–¢—é–º–µ–Ω—å"}]},restrict_value:!0}),k.suggestions({token:b,type:E,scrollOnFocus:!0,onSelect:w,onSelectNothing:M,hint:!1,noSuggestionsHint:!1,bounds:"house",constraints:H});o.platform;var D=S();guuid_platform=" GUID: "+D,$("#guuid").text(guuid_platform),function(){let n=localStorage.getItem("t_name"),a=localStorage.getItem("t_phone"),l=localStorage.getItem("t_address"),r=localStorage.getItem("t_house"),u=localStorage.getItem("t_flat"),i=localStorage.getItem("t_floor"),s=localStorage.getItem("t_entrance"),m=localStorage.getItem("t_intercom");n&&(console.log("–ù–∞–π–¥–µ–Ω: –∏–º—è"),$("#name").val(n)),a&&(console.log("–ù–∞–π–¥–µ–Ω: –¢–µ–ª–µ—Ñ–æ–Ω"),$("#phone").val(a)),r&&(console.log("–ù–∞–π–¥–µ–Ω: –¥–æ–º"),$("#house").val(r)),u&&(console.log("–ù–∞–π–¥–µ–Ω: –∫–≤"),$("#flat").val(u)),i&&(console.log("–ù–∞–π–¥–µ–Ω: —ç—Ç–∞–∂"),$("#floor").val(i)),s&&(console.log("–ù–∞–π–¥–µ–Ω: –ø–æ–¥—ä–µ–∑–¥"),$("#entrance").val(s)),m&&(console.log("–ù–∞–π–¥–µ–Ω: –¥–æ–º–æ—Ñ–æ–Ω"),$("#intercom").val(m)),localStorage.getItem("t_address")?(console.log("–ê–¥—Ä–µ—Å –Ω–∞–π–¥–µ–Ω –ø–æ–¥–≥—Ä—É–∂–∞—é"),$("#street").val(l),k.on("suggestions-fixdata",(function(e,t){})),k.suggestions().fixData(),t(e),o.MainButton.show()):console.log("–ê–¥—Ä–µ—Å –ø—É—Å—Ç–æ–π")}(),Telegram.WebApp.onEvent("mainButtonClicked",(function(){console.log("–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π ");for(var e=document.querySelectorAll(".option-input"),t=0;t<e.length;t++)if(e[t].checked){_=e[t].value;break}if(function(e){var t=$("#name").val(),o=$("#phone").val();if(t.length<1)return document.getElementById("name").focus(),$("#name")[0].reportValidity(),!0;if(o.length<18)return document.getElementById("phone").focus(),$("#phone")[0].reportValidity(),!0;if(!u&&"delivery"==e){if($("#street").val(),$("#house").val(),null==B)return document.getElementById("street").focus(),$("#street")[0].reportValidity(),!0;if(null==B.house)return document.getElementById("house").focus(),$("#house")[0].reportValidity(),!0}return!1}(_))return console.log("–û—à–∏–±–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö"),!1;var n=o.platform,a=S();if("delivery"==_){if(u)l="",r="",i="",s="",m="",c="",d="",g=0;else{var l=tg_kladrid,r=tg_street,i=tg_house,s=tg_building,m=tg_geo_lat,c=tg_geo_lon,d=tg_full_street,g=tg_qc_geo;localStorage.setItem("t_address",r),localStorage.setItem("t_house",i)}var _="üöõ –î–æ—Å—Ç–∞–≤–∫–∞",f=document.getElementById("dining-number").value,v=document.getElementById("select").value,h=document.getElementById("name").value,p=document.getElementById("flat").value,y=document.getElementById("floor").value,I=document.getElementById("entrance").value,b=document.getElementById("intercom").value,E=document.getElementById("phone").value,H=document.getElementById("about").value;localStorage.setItem("t_flat",p),localStorage.setItem("t_floor",y),localStorage.setItem("t_entrance",I),localStorage.setItem("t_intercom",b),data={platform:n,guuid:a,dostavka:_,cutlery:f,delivery_time:v,name:h,phone:E,kladrid:l,full_street:d,qc_geo:g,street:r,house:i,building:s,flat:p,floor:y,entrance:I,intercom:b,geo_lat:m,geo_lon:c,about:H}}else{_="üèÉ –ù–∞–≤—ã–Ω–æ—Å",f=document.getElementById("dining-number").value,v=document.getElementById("select").value,h=document.getElementById("name").value,E=document.getElementById("phone").value,H=document.getElementById("about").value;data={platform:n,guuid:a,dostavka:_,cutlery:f,delivery_time:v,name:h,phone:E,about:H}}localStorage.setItem("t_name",h),localStorage.setItem("t_phone",E),o.sendData(JSON.stringify(data))}));