validParams=["time_zone","work_hours","limit_streets"];const params=window.location.search.substring(1).split("&"),filteredParams=params.filter(a=>([name]=a.split("="),validParams.includes(name))),obj={};for(const a of filteredParams){const[b,c]=a.split("=");obj[b]=c}var work_hours=obj.work_hours.split(","),time_zone=obj.time_zone,limit_streets=JSON.parse(obj.limit_streets),work_hours_open=moment(work_hours[0],"HH:mm"),work_hours_close=moment(work_hours[1],"HH:mm"),today=new moment().format(),today=moment.tz(today,time_zone),tomorrow=new moment().add(1,"days").format(),tomorrow=moment.tz(tomorrow,time_zone);if(limit_streets){var elem=document.getElementById("streetlimit");elem.parentNode.removeChild(elem)}function work(){var a=+today.format("HH");return work_hours_open.format("HH")<=a?a+1:work_hours_open.format("HH")}for(var selection="<option value='now'>\u231A\uFE0F \u0411\u043B\u0438\u0436\u0430\u0439\u0448\u0435\u0435 \u0432\u0440\u0435\u043C\u044F</option>",i=0,i=work();i<work_hours_close.format("HH");i++){var j=zeroFill(i,2),date=moment(today),timeStr=j,time=moment(timeStr,"HH:mm");date.set({hour:time.get("hour"),minute:time.get("minute"),second:time.get("second")});var today_min=+today.format("mm");30>=today_min&&(selection+="<option value='"+date.format()+"'>\u231A\uFE0F "+j+":00 \u0421\u0435\u0433\u043E\u0434\u043D\u044F</option>");var date=moment(today),timeStr=j+30,time=moment(timeStr,"HH:mm");date.set({hour:time.get("hour"),minute:time.get("minute"),second:time.get("second")}),selection+="<option value='"+date.format()+"'>\u231A\uFE0F "+j+":30 \u0421\u0435\u0433\u043E\u0434\u043D\u044F</option>"}for(var i=work_hours_open.format("HH");i<work_hours_close.format("HH");i++){var j=zeroFill(i,2),date=moment(tomorrow),timeStr=j,time=moment(timeStr,"HH:mm");date.set({hour:time.get("hour"),minute:time.get("minute"),second:time.get("second")}),selection+="<option value='"+date.format()+"'>\u231A\uFE0F "+j+":00 \u0417\u0430\u0432\u0442\u0440\u0430</option>";var date=moment(tomorrow),timeStr=j+30,time=moment(timeStr,"HH:mm");date.set({hour:time.get("hour"),minute:time.get("minute"),second:time.get("second")}),selection+="<option value='"+date.format()+"'>\u231A\uFE0F "+j+":30 \u0417\u0430\u0432\u0442\u0440\u0430</option>"}$("select").html(selection);function zeroFill(a,b){return b-=a.toString().length,0<b?Array(b+(/\./.test(a)?2:1)).join("0")+a:a+""}window.addEventListener("DOMContentLoaded",function(){[].forEach.call(document.querySelectorAll(".tel"),function(a){function b(a){a.keyCode&&(c=a.keyCode);var b=this.selectionStart;3>b&&a.preventDefault();var d=0,e="+7 (___) ___-__-__".replace(/\D/g,""),f=this.value.replace(/\D/g,""),g="+7 (___) ___-__-__".replace(/[_\d]/g,function(b){return d<f.length?f.charAt(d++)||e.charAt(d):b});d=g.indexOf("_"),-1!=d&&(5>d&&(d=3),g=g.slice(0,d));var h="+7 (___) ___-__-__".substr(0,this.value.length).replace(/_+/g,function(b){return"\\d{1,"+b.length+"}"}).replace(/[+()]/g,"\\$&");h=new RegExp("^"+h+"$"),(!h.test(this.value)||5>this.value.length||47<c&&58>c)&&(this.value=g),"blur"==a.type&&5>this.value.length&&(this.value="")}var c;a.addEventListener("input",b,!0),a.addEventListener("focus",b,!0),a.addEventListener("blur",b,!0),a.addEventListener("keydown",b,!0)})});var tg=window.Telegram.WebApp;tg.expand(),tg.MainButton.text="\u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C",tg.MainButton.setText("\u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C"),tg.MainButton.textColor="#FFFFFF",tg.MainButton.color="#32746a",tg.MainButton.setParams({color:"#32746a"}),tg.MainButton.show(),tg.MainButton.enable();const token="ae88835bdbe058921eb8012bc6b79a7a7e606ac9";var selectedAddress,type="ADDRESS",$street=$("#street"),$house=$("#house"),$message=$("#message");$street.suggestions({token:"ae88835bdbe058921eb8012bc6b79a7a7e606ac9",type:"ADDRESS",scrollOnFocus:!0,onSelect:selectAddress,onSelectNothing:selectNone,hint:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0430\u0440\u0438\u0430\u043D\u0442 \u0438\u043B\u0438 \u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u0435 \u0432\u0432\u043E\u0434",bounds:"street",constraints:{locations:[{city:"\u0422\u044E\u043C\u0435\u043D\u044C"}]},restrict_value:!0}),$house.suggestions({token:"ae88835bdbe058921eb8012bc6b79a7a7e606ac9",type:"ADDRESS",scrollOnFocus:!0,onSelect:selectAddress,onSelectNothing:selectNone,hint:!1,noSuggestionsHint:!1,bounds:"house",constraints:$street});function selectAddress(a){console.log(a),a.data.house?console.log("\u0412\u0435\u0440\u043D\u043E, \u043C\u043E\u0436\u043D\u043E \u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0430\u0442\u044C!"):(console.log("\u0423\u043A\u0430\u0436\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441 \u0434\u043E \u0434\u043E\u043C\u0430, \u0447\u0442\u043E\u0431\u044B \u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C"),$("#house")[0].reportValidity(),document.getElementById("house").focus()),selectedAddress=a.data,seladdr=a.data.city_kladr_id,tg_kladrid=a.data.street_kladr_id,tg_street=a.data.street_with_type,tg_house=a.data.house_type+" "+a.data.house,tg_geo_lat=a.data.geo_lat,tg_geo_lon=a.data.geo_lon,tg_building=null==a.data.block?"":a.data.block_type+" "+a.data.block}function selectNone(){selectedAddress=null}function data_verification(a){var b=$("#name").val(),c=$("#phone").val();if(1>b.length)return document.getElementById("name").focus(),$("#name")[0].reportValidity(),!0;if(18>c.length)return document.getElementById("phone").focus(),$("#phone")[0].reportValidity(),console.log("\u041D\u0435 \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D \u043D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430"),!0;if(!limit_streets&&"delivery"==a){console.log("\u0412\u044B\u0431\u0440\u0430\u043D\u043E \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0430");var d=$("#street").val(),e=$("#house").val();if(null==selectedAddress)return console.log("\u041D\u0435 \u0412\u044B\u0431\u0440\u0430\u043D \u0430\u0434\u0440\u0435\u0441"),document.getElementById("street").focus(),$("#street")[0].reportValidity(),console.log("\u0414\u043E\u043C: "+tg_house,"\u041A\u043E\u0440\u043F\u0443\u0441 \u0441\u0442\u0440\u043E\u0435\u043D\u0438\u0435: "+tg_building),!0;if(null==selectedAddress.house)return console.log("\u041D\u0435 \u0412\u044B\u0431\u0440\u0430\u043D \u0434\u043E\u043C"),document.getElementById("house").focus(),$("#house")[0].reportValidity(),console.log("\u0414\u043E\u043C: "+tg_house,"\u041A\u043E\u0440\u043F\u0443\u0441 \u0441\u0442\u0440\u043E\u0435\u043D\u0438\u0435: "+tg_building),!0}return!1}Telegram.WebApp.onEvent("mainButtonClicked",function(){console.log("\u041F\u0440\u043E\u0432\u0435\u0440\u043A\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u043D\u0430 \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0435 \u043F\u043E\u043B\u0435\u0439 ");for(var a=document.querySelectorAll(".option-input"),b=0;b<a.length;b++)if(a[b].checked){j=a[b].value;break}if(data_verification(j))return console.log("\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F \u0434\u0430\u043D\u043D\u044B\u0445"),!1;if(console.log("\u0414\u0430\u043D\u043D\u044B\u0435 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u044B ",j),"delivery"==j){if(!limit_streets)var c=tg_kladrid,d=tg_street,e=tg_house,f=tg_building,g=tg_geo_lat,h=tg_geo_lon;else var c="",d="",e="",f="",g="",h="";var j="\uD83D\uDE9B \u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430",k=document.getElementById("dining-number"),l=document.getElementById("select").value,m=document.getElementById("name").value,n=document.getElementById("flat").value,o=document.getElementById("floor").value,p=document.getElementById("entrance").value,q=document.getElementById("intercom").value,r=document.getElementById("phone").value,s=document.getElementById("about").value;console.log(j,k,l,m,r,c,d,e,f,n,o,p,q,g,h,s),data={dostavka:j,dining_number:k,delivery_time:l,name:m,phone:r,kladrid:c,street:d,house:e,building:f,flat:n,floor:o,entrance:p,intercom:q,geo_lat:g,geo_lon:h,about:s}}else{var j="\uD83C\uDFC3 \u041D\u0430\u0432\u044B\u043D\u043E\u0441",l=document.getElementById("select").value,m=document.getElementById("name").value,r=document.getElementById("phone").value,s=document.getElementById("about").value;data={dostavka:j,dining_number:k,delivery_time:l,name:m,phone:r,about:s}}tg.sendData(JSON.stringify(data))});